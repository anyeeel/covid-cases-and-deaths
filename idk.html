<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <title>COVID Cases</title>
    <style>
        body {
          display: flex;
          flex-direction: column;
          align-items: center;
          margin: 0;
          padding: 0;
          background-color: #1d2630;
          font-family: 'Varela Round', sans-serif;
        }
  
        h1 {
          margin-top: 2rem;
          margin-bottom: 1rem;
          color: #fffbfb;
        }
  
        form {
          margin-bottom: 2rem;
          background-color: #686d6b86;
          border-radius: 5px;
          padding: 1rem;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
  
        form label {
          display: inline-block;
          width: 80px;
          color: #fff;
        }
  
        form input {
          margin-bottom: 0.5rem;
          padding: 0.25rem 0.5rem;
          border: 1px solid #ccc;
          border-radius: 3px;
        }
  
        button[type="button"] {
          background-color: #4a90e2;
          border: none;
          border-radius: 3px;
          color: #fff;
          padding: 0.5rem 1rem;
          cursor: pointer;
        }
  
        button[type="button"]:hover {
          background-color: #3d7ccd;
        }
  
        table {
          width: 80%;
          border-collapse: collapse;
          background-color: #fff;
          border-radius: 5px;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
  
        th {
          background-color: #4a90e2;
          color: #111111;
          padding: 0.75rem;
          text-align: left;
        }
  
        td {
          padding: 0.75rem;
          text-align: left;
        }
  
        button.edit-button,
        button.delete-button {
          background-color: #4a90e2;
          border: none;
          border-radius: 3px;
          color: #fff;
          padding: 0.5rem;
          cursor: pointer;
          margin-right: 0.5rem;
        }
  
        button.edit-button:hover {
          background-color: #3d7ccd;
        }
  
        button.delete-button {
          background-color: #e74c3c;
        }
  
        button.delete-button:hover {
          background-color: #c0392b;
        }

      table {

        border-collapse: collapse;
      }

      th,
      td {
        border: 1px solid black;
        padding: 8px;
        text-align: left;
      }

      th {
        background-color: #f2f2f2;
      }

      .modal {
        display: none;
        position: fixed;
        z-index: 1;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        overflow: auto;
        background-color: rgba(0, 0, 0, 0.5);
        color: #f2f2f2;
      }

      .modal-content {
        background-color: #383737;
        margin: 15% auto;
        padding: 20px;
        border: 1px solid #888;
        width: 80%;
      }
    </style>
  
  <body>
    <h1>COVID Cases</h1>
    <form>
      <label for="country">Country:</label>
      <input type="text" id="country" name="country" /><br />
      <label for="cases">Cases:</label>
      <input type="text" id="cases" name="cases" /><br />
      <button type="button" onclick="addData()">Add Data</button>
    </form>
    <table>
      <thead>
        <tr>
          <th>Country</th>
          <th>Cases</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="covid-cases">
      </tbody>
    </table>

    <div id="edit-form" class="modal">
        <div class="modal-content">
          <h2>Edit Case</h2>
          <form>
            <input type="hidden" id="edit-id" />
            <label for="edit-country">Country:</label>
            <input type="text" id="edit-country" name="country" /><br />
            <label for="edit-cases">Cases:</label>
            <input type="text" id="edit-cases" name="cases" /><br />
            <button type="button" onclick="submitEditForm()">Update Data</button>
            <button type="button" onclick="hideEditForm()">Cancel</button>
          </form>
        </div>
      </div>
      

    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script>
      // Initialize Firebase
      const firebaseConfig = {
        apiKey: "AIzaSyCaXgBZcBkfZRF5X-YPNFhvY-C7ufceAWg",
        authDomain: "ababonfirebase.firebaseapp.com",
        databaseURL: "https://ababonfirebase-default-rtdb.firebaseio.com",
        projectId: "ababonfirebase",
        storageBucket: "ababonfirebase.appspot.com",
        messagingSenderId: "809851666126",
        appId: "1:809851666126:web:ef2f47cb874fd27380da9f",
        measurementId: "G-DB5B08LYHE"
      };
      firebase.initializeApp(firebaseConfig);
      const db = firebase.firestore();

      function showAlert(message) {
        Swal.fire({
          title: 'Success',
          text: message,
          icon: 'success',
          confirmButtonText: 'OK',
        });
      }
      
      // Add data to Firestore
      function addData() {
        const country = document.getElementById("country").value;
        const cases = document.getElementById("cases").value;
        db.collection("covid-cases")
          .add({
            country: country,
            cases: cases,
          })
          .then((docRef) => {
            console.log("Document written with ID: ", docRef.id);
            showAlert("New data successfully added.");
          })          
          .catch((error) => {
            console.error("Error adding document: ", error);
          });
      }

      // Show edit form
      function showEditForm(id, country, cases) {
        document.getElementById("edit-form").style.display = "block";
        document.getElementById("edit-id").value = id;
        document.getElementById("edit-country").value = country;
        document.getElementById("edit-cases").value = cases;
      }

            // Submit the edit form
            function submitEditForm() {
                const id = document.getElementById("edit-id").value;
                const country = document.getElementById("edit-country").value;
                const cases = document.getElementById("edit-cases").value;
                updateData(id, { country: country, cases: cases });
                document.getElementById("edit-form").style.display = "none";
              }
        
              // Update data in Firestore
              function updateData(id, data) {
                db.collection("covid-cases")
                  .doc(id)
                  .update(data)
                  .then(() => {
                    console.log("Document updated");
                    showAlert("Edit data successfully.");
                  })
                  
                  .catch((error) => {
                    console.error("Error updating document: ", error);
                  });
              }
        
              // Delete data from Firestore
              function deleteData(id) {
                db.collection("covid-cases")
                  .doc(id)
                  .delete()
                  .then(() => {
                    console.log("Document deleted");
                    showAlert("Data deleted successfully.");
                  })
                  .catch((error) => {
                    console.error("Error deleting document: ", error);
                  });
                }
        
              // Get data from Firestore
              db.collection("covid-cases").onSnapshot((querySnapshot) => {
                const covidCasesTable = document.getElementById("covid-cases");
                covidCasesTable.innerHTML = "";
                querySnapshot.forEach((doc) => {
                  const data = doc.data();
                  const row = document.createElement("tr");
                  const countryCell = document.createElement("td");
                  const casesCell = document.createElement("td");
                  const actionsCell = document.createElement("td");
                  const updateButton = document.createElement("button");
                  const deleteButton = document.createElement("button");
                  countryCell.textContent = data.country;
                  casesCell.textContent = data.cases;
                  updateButton.textContent = "Update";
                  deleteButton.textContent = "Delete";
                  updateButton.addEventListener("click", () => {
                    showEditForm(doc.id, data.country, data.cases);
                  });
                  deleteButton.addEventListener("click", () => {
                    deleteData(doc.id);
                  });
                  actionsCell.appendChild(updateButton);
                  actionsCell.appendChild(deleteButton);
                  row.appendChild(countryCell);
                  row.appendChild(casesCell);
                  row.appendChild(actionsCell);
                  covidCasesTable.appendChild(row);
                });
              });
            </script>
          </body>
        </html>
        